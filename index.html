<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-10550309-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-10550309-8');
</script>

<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript">google.load("jquery", "1.3.2");</script>

<style type="text/css">
    body {
        font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
        font-weight:300;
        font-size:18px;
        margin-left: auto;
        margin-right: auto;
        width: 1100px;
    }

    h1 {
        font-weight:300;
    }

    .disclaimerbox {
        background-color: #eee;
        border: 1px solid #eeeeee;
        border-radius: 10px ;
        -moz-border-radius: 10px ;
        -webkit-border-radius: 10px ;
        padding: 20px;
    }

    video.header-vid {
        height: 140px;
        border: 1px solid black;
        border-radius: 10px ;
        -moz-border-radius: 10px ;
        -webkit-border-radius: 10px ;
    }

    img.header-img {
        height: 140px;
        border: 1px solid black;
        border-radius: 10px ;
        -moz-border-radius: 10px ;
        -webkit-border-radius: 10px ;
    }

    img.rounded {
        border: 1px solid #eeeeee;
        border-radius: 10px ;
        -moz-border-radius: 10px ;
        -webkit-border-radius: 10px ;
    }

    a:link,a:visited
    {
        color: #1367a7;
        text-decoration: none;
    }
    a:hover {
        color: #208799;
    }

    td.dl-link {
        height: 160px;
        text-align: center;
        font-size: 22px;
    }

    .layered-paper-big { /* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
        box-shadow:
                0px 0px 1px 1px rgba(0,0,0,0.35), /* The top layer shadow */
                5px 5px 0 0px #fff, /* The second layer */
                5px 5px 1px 1px rgba(0,0,0,0.35), /* The second layer shadow */
                10px 10px 0 0px #fff, /* The third layer */
                10px 10px 1px 1px rgba(0,0,0,0.35), /* The third layer shadow */
                15px 15px 0 0px #fff, /* The fourth layer */
                15px 15px 1px 1px rgba(0,0,0,0.35), /* The fourth layer shadow */
                20px 20px 0 0px #fff, /* The fifth layer */
                20px 20px 1px 1px rgba(0,0,0,0.35), /* The fifth layer shadow */
                25px 25px 0 0px #fff, /* The fifth layer */
                25px 25px 1px 1px rgba(0,0,0,0.35); /* The fifth layer shadow */
        margin-left: 10px;
        margin-right: 45px;
    }


    .layered-paper { /* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
        box-shadow:
                0px 0px 1px 1px rgba(0,0,0,0.35), /* The top layer shadow */
                5px 5px 0 0px #fff, /* The second layer */
                5px 5px 1px 1px rgba(0,0,0,0.35), /* The second layer shadow */
                10px 10px 0 0px #fff, /* The third layer */
                10px 10px 1px 1px rgba(0,0,0,0.35); /* The third layer shadow */
        margin-top: 5px;
        margin-left: 10px;
        margin-right: 30px;
        margin-bottom: 5px;
    }

    .vert-cent {
        position: relative;
        top: 50%;
        transform: translateY(-50%);
    }

    hr
    {
        border: 0;
        height: 1.5px;
        background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));
    }
</style>

<html>
  <head>
        <title>Adaptive Control of SE(3) Hamiltonian Dynamics with Learned Disturbance Features</title>
        <meta property="og:title" content="SE3HamDL" />
        <meta property="og:image" content="" />
        <meta property="og:url" content="" />
      <style>
code {
  font-family: Consolas,"courier new";
  color: darkcyan;
  background-color: #f1f1f1;
  padding: 2px;
  font-size: 105%;
}
</style>
  </head>

  <body>
    <br>
    <center>
    <span style="font-size:42px">Adaptive Control of SE(3) Hamiltonian Dynamics with Learned Disturbance Features</span>
    
    </center>

    <br><br>
      <table align=center width=400px>
       <tr>
         <td align=center width=100px>
         <center>
         <span style="font-size:20px"><a href="https://thaipduong.github.io/">Thai Duong</a></span>
         </center>
         </td>

        <td align=center width=100px>
        <center>
        <span style="font-size:20px"><a href="https://natanaso.github.io/">Nikolay Atanasov</a></span>
        </center>
        </td>
     </tr>
    </table>

    <table align=center width=700px>
       <tr>
        <td align=center width=100px>
        <center>
        <span style="font-size:20px">Department of Electrical and Computer Engineering <br> University of California, San Diego<br/>In Submission, 2021.</span>
        </center>
        </td>
     </tr>
    </table>

    <br>

    <table align=center width=500px>
     <tr>
       <td align=center width=100px>
       <center>
       <span style="font-size:20px"><a href="https://arxiv.org/pdf/2109.09974.pdf">[Paper]</a></span>
       </center>
       </td>
       <td align=center width=100px>
       <center>
       <span style="font-size:20px"><a href="https://thaipduong.github.io/hamadapt/">[Code (TBD)]</a></span>
       </center>
       </td>
    
   </tr>
  </table>

            <br>
            

            <br>
            Adaptive control is a critical component of reliable robot autonomy in rapidly changing operational conditions. Adaptive control designs benefit from a disturbance model, which is often unavailable in practice. This motivates the use of machine learning techniques to learn disturbance features from training data offline, which can subsequently be employed to compensate the disturbances online. This paper develops geometric adaptive control with a learned disturbance model for rigid-body systems, such as ground, aerial, and underwater vehicles, that satisfy Hamilton's equations of motion over the SE(3) manifold. Our design consists of an offline disturbance model identification stage, using a Hamiltonian-based neural ordinary differential equation (ODE) network trained from state-control trajectory data, and an online adaptive control stage, estimating and compensating the disturbances based on geometric tracking errors. We demonstrate our adaptive geometric controller in trajectory tracking simulations of fully-actuated pendulum and under-actuated quadrotor systems.
            <br><br>

      <hr>
               <!-- <table align=center width=550px> -->
            <table align=center width=900>
             <center><h1>Paper</h1></center>
                <tr>
                    <!--<td width=300px align=left>-->
                    <!-- <a href="http://arxiv.org/pdf/1603.08511.pdf"> -->
                  <!-- <td><a href="#"><img class="layered-paper-big" style="height:175px" src="./resources/images/paper.png"/></a></td> -->
                  <td><a href="https://arxiv.org/pdf/2109.09974.pdf"><img style="height:300px" src="./resources/images/thumbnails.png"/></a></td>
                  <td><span style="font-size:14pt">Thai Duong, Nikolay Atanasov<br><br>
                          Adaptive Control of SE(3) Hamiltonian Dynamics with Learned Disturbance Features<br><br>
                  In Submission, 2021.<br><br>
                      <a href="https://arxiv.org/pdf/2109.09974.pdf">[pdf]</a> &nbsp; &nbsp;
                   <!--    <a href="./resources/bibtex.txt">[Bibtex]</a> -->
                  <!-- [hosted on <a href="#">arXiv</a>]</a> -->
                    </td>
              </tr>
            </table>
      

      

          <hr>
         <!-- <table align=center width=550px> -->
            <table align=center width=800>
             <center><h1>Overview and Results</h1></center>
                <tr>
                    <br>
            <td width=600px>
                      <center>
                          <span style="font-size:28px">Problem Settings
                          <br>
                          <br>
                    </center>
                    </td>
            <br>
            <table align=center width=600px>
                <tr>
                    <td width=600px>
                      <center>
                          <a href="./resources/images/problemsetting.png"><img src = "./resources/images/problemsetting.png" width="900px"></img></href></a><br>
                    </center>
                    </td>
                </tr>
                    <td width=600px>
                      <center>
                          <span style="font-size:18px"><i> Given a training dataset from state-control tracjectories collected under different disturbance realizations, we want to learn an adaptive controller, consisting of a trajectory-tracking controller that compensates for the disturbances and an adaptation law that estimates the disturbances online.</i>
                    </center>
                    </td>
                </tr>
            </table>
                <br><br>
                    <table align=center width=600px>
                <tr>
                    <td width=600px>
                      <center>
                          <a href="./resources/images/stateconstraints.png"><img src = "./resources/images/stateconstraints.png" width="900px"></img></href></a><br>
                    </center>
                    </td>
                </tr>
                    <td width=600px>
                      <center>
                          <span style="font-size:18px"><i>The dynamics of many robots, including ground, aerial, and underwater vehicles, are described in terms of their SE(3) pose and generalized velocity, which evolves on the SE(3) manifold, and satisfy conservation of energy principles</i>
                    </center>
                    </td>
                </tr>
            </table>
<br><br>
            <td width=600px>
                      <center>
                          <span style="font-size:28px">Technical Approach
                          <br>
                          <br>
                    </center>
                    </td>
                <table align=center width=600px>
                <tr>
                    <td width=600px>
                      <center>
                          <a href="./resources/images/technicalapproach.png"><img src = "./resources/images/technicalapproach.png" width="900px"></img></href></a><br>
                    </center>
                    </td>
                </tr>
                    <td width=600px>
                      <center>
                          <span style="font-size:18px"><i> Our approach consists of two stages: 1) offline disturbance model learning; and 2) online adaptive control.</i>
                    </center>
                    </td>
                </tr>
            </table>
            <br><br>
                <table align=center width=600px>
                <tr>
                    <td width=600px>
                      <center>
                          <a href="./resources/images/archdesign.png"><img src = "./resources/images/archdesign.png" width="900px"></img></href></a><br>
                    </center>
                    </td>
                </tr>
                    <td width=600px>
                      <center>
                          <span style="font-size:18px"><i> We design the architecture of the neural ODE network using the Hamilton's equations of motion on the SE(3) with parameter theta for disturbance model.</i>
                    </center>
                    </td>
                </tr>
            </table>
            <br><br>
                <table align=center width=600px>
                <tr>
                    <td width=600px>
                      <center>
                          <a href="./resources/images/onlineadaptivecontrol.png"><img src = "./resources/images/onlineadaptivecontrol.png" width="900px"></img></href></a><br>
                    </center>
                    </td>
                </tr>
                    <td width=600px>
                      <center>
                          <span style="font-size:18px"><i> The Hamiltonian structure is used to design a trajectory-tracking controller from and energy perspective while the disturbance model with parameter theta is used to develop the adaptaion law.</i>
                    </center>
                    </td>
                </tr>
            </table>

            <br><br>
            <td width=600px>
                      <center>
                          <span style="font-size:28px"> Results
                          <br>
                          <br>
                    </center>
                    </td>
<table align=center width=900px>
                <tr>
                    <td width=900px>
                      <center>
                    <a href="./resources/gif/pendulum/control_theta_thetadot_u_f.gif"><img src = "./resources/gif/pendulum/control_theta_thetadot_u_f.gif" width="450px"></img></href></a>
                    <a href="./resources/gif/pendulum/gym_animation_control.gif"><img src = "./resources/gif/pendulum/gym_animation_control.gif" width="350px"></img></href></a>
                    
                    <br>
                    </center>
                    </td>
                </tr>
                    <td width=600px>
                      <center>
                          <span style="font-size:18px"><i> For pendulum, we collect data by applying random control on a pendulum gym simulator. After learning the disturbance model from data, the proposed adaptive controller drives the pendulum toward the angle 3*pi/4 using the learned dynamics.</i>
                    </center>
                    </td>
                </tr>
            </table>
            <br><br>

                <table align=center width=900px>
                <tr>
                    <td width=900px>
                      <center>
                    <a href="./resources/gif/data1.gif"><img src = "./resources/gif/data1.gif" width="260px"></img></href></a>
                    <a href="./resources/gif/data2.gif"><img src = "./resources/gif/data2.gif" width="260px"></img></href></a>
                    <a href="./resources/gif/data2.gif"><img src = "./resources/gif/data11.gif" width="260px"></img></href></a>
                    <a href="./resources/gif/data2.gif"><img src = "./resources/gif/data15.gif" width="260px"></img></href></a>
                    <a href="./resources/gif/data2.gif"><img src = "./resources/gif/data14.gif" width="260px"></img></href></a>
                    <a href="./resources/gif/data2.gif"><img src = "./resources/gif/data13.gif" width="260px"></img></href></a>
                    <a href="./resources/gif/data2.gif"><img src = "./resources/gif/data18.gif" width="260px"></img></href></a>
                    <a href="./resources/gif/data2.gif"><img src = "./resources/gif/data21.gif" width="260px"></img></href></a>
                    <a href="./resources/gif/data2.gif"><img src = "./resources/gif/data4.gif" width="260px"></img></href></a>

                    <br>
                    </center>
                    </td>
                </tr>
                    <td width=600px>
                      <center>
                          <span style="font-size:18px"><i> For quadrotors, we use a crazyflie drone simulator in Pybullet and collect training data from 9 flights under 8 disturbance realizations.</i>
                    </center>
                    </td>
                </tr>
            </table>
            <br><br>
            <table align=center width=900px>
                <tr>
                    <td width=900px>
                      <center>
                    <a href="./resources/gif/quadrotor/32/exp1_noadaptive_2d.gif"><img src = "./resources/gif/quadrotor/32/exp1_noadaptive_2d.gif" width="500px"></img></href></a>
                    <a href="./resources/gif/quadrotor/exp1_noadaptive_3d.gif"><img src = "./resources/gif/quadrotor/32/exp1_noadaptive_3d.gif" width="300px"></img></href></a>
                    <a href="./resources/gif/quadrotor/32/video_exp1_noadaptive32.gif"><img src = "./resources/gif/quadrotor/32/video_exp1_noadaptive32.gif" width="800px"></img></href></a>
                    
                    <br>
                    </center>
                    </td>
                </tr>
                    <td width=600px>
                      <center>
                          <span style="font-size:18px"><i>Experiment 1 (no adaptive control + spiral trajectory): the drone drifts due to external winds and defective rotors.</i>
                    </center>
                    </td>
                </tr>
                <tr>
                    <td width=900px>
                      <center>
                    <a href="./resources/gif/quadrotor/32/exp1_adaptive_2d.gif"><img src = "./resources/gif/quadrotor/32/exp1_adaptive_2d.gif" width="500px"></img></href></a>
                    <a href="./resources/gif/quadrotor/32/exp1_adaptive_3d.gif"><img src = "./resources/gif/quadrotor/32/exp1_adaptive_3d.gif" width="300px"></img></href></a>
                    <a href="./resources/gif/quadrotor/32/video_exp1_adaptive32.gif"><img src = "./resources/gif/quadrotor/32/video_exp1_adaptive32.gif" width="800px"></img></href></a>
                    
                    <br>
                    </center>
                    </td>
                </tr>
                    <td width=600px>
                      <center>
                          <span style="font-size:18px"><i>Experiment 1 (adaptive control + spiral trajectory): we can estimate the disturbance after a few seconds, compensate for it and successfully finish the tracking task.</i>
                    </center>
                    </td>
                </tr>
                <tr>
                    <td width=900px>
                      <center>
                    <a href="./resources/gif/quadrotor/32/exp2_noadaptive_2d.gif"><img src = "./resources/gif/quadrotor/32/exp2_noadaptive_2d.gif" width="500px"></img></href></a>
                    <a href="./resources/gif/quadrotor/32/exp2_noadaptive_3d.gif"><img src = "./resources/gif/quadrotor/32/exp2_noadaptive_3d.gif" width="300px"></img></href></a>
                    <a href="./resources/gif/quadrotor/32/video_exp2_noadaptive32.gif"><img src = "./resources/gif/quadrotor/32/video_exp2_noadaptive32.gif" width="800px"></img></href></a>
                    
                    <br>
                    </center>
                    </td>
                </tr>
                    <td width=600px>
                      <center>
                          <span style="font-size:18px"><i>Experiment 2 (no adaptive control + diamond-shaped trajectory): as the rotors suddenly become defective after 5s, The drone drifts and drops down to the ground due to disturbances.</i>
                    </center>
                    </td>
                </tr>
                <tr>
                    <td width=900px>
                      <center>
                    <a href="./resources/gif/quadrotor/32/exp2_adaptive_2d.gif"><img src = "./resources/gif/quadrotor/32/exp2_adaptive_2d.gif" width="500px"></img></href></a>
                    <a href="./resources/gif/quadrotor/32/exp2_adaptive_3d.gif"><img src = "./resources/gif/quadrotor/32/exp2_adaptive_3d.gif" width="300px"></img></href></a>
                    <a href="./resources/gif/quadrotor/32/video_exp2_adaptive32.gif"><img src = "./resources/gif/quadrotor/32/video_exp2_adaptive32.gif" width="800px"></img></href></a>
                    
                    <br>
                    </center>
                    </td>
                </tr>
                    <td width=600px>
                      <center>
                          <span style="font-size:18px"><i>Experiment 2 (adaptive control + diamond-shaped trajectory): the drone is able to recover and finishes tracking the trajectory.</i>
                    </center>
                    </td>
                </tr>
            </table>

              </tr>

            </table>
            <br>

          

        <hr>
         <center><h1>Code (TBD)</h1></center>
            <table align=center width=800px>
              <tr><center> <br>
                <span style="font-size:28px">&nbsp;<a href='https://thaipduong.github.io/hamadapt'>[github]</a>

                <span style="font-size:28px"></a></span>
              <br>
              </center></tr>
          </table>
            <br>
          <hr>

         
            <br>
          <hr>

            <table align=center width=1100px>
                <tr>
                    <td>
                      <left>
                <center><h1>Acknowledgements</h1></center>
                We gratefully acknowledge support from NSF RI IIS-2007141 and ARL DCIST CRA W911NF-17-2-0181.
                <br>
                This webpage template was borrowed from <a href="https://akanazawa.github.io/cmr/">https://akanazawa.github.io/cmr/</a>.
            </left>
        </td>
        </tr>
        </table>
<div style="display:inline-block;width:200px;"><script type="text/javascript" src="//rf.revolvermaps.com/0/0/7.js?i=5wg2lm1wafs&amp;m=6&amp;c=ff0000&amp;cr1=ffffff&amp;sx=0" async="async"></script></div>

        <br><br>
</body>
</html>
